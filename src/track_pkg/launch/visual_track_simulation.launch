<?xml version="1.0"?>
<launch>
    <!-- 启动Gazebo仿真环境 -->
    <include file="$(find track_pkg)/launch/gazebo_simulation.launch"/>

    <!-- 启动前车遥控节点 -->
    <node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" name="teleop" output="screen">
        <remap from="cmd_vel" to="leader/cmd_vel"/>
        <param name="repeat_rate" value="10.0"/>
    </node>

    <!-- 启动视觉跟踪节点 -->
    <node pkg="track_pkg" type="visual_tracker_node" name="visual_tracker" output="screen">
        <!-- 跟踪参数配置 -->
        <param name="max_linear_speed" value="0.5"/>
        <param name="min_linear_speed" value="0.0"/>
        <param name="min_distance" value="2.5"/>  <!-- 单位：米 -->
        <param name="max_distance" value="4.0"/>  <!-- 单位：米 -->
        <param name="max_rotation_speed" value="0.75"/>
        <param name="k_rotation_speed" value="0.01"/>

        <!-- 话题重映射 -->
        <remap from="/camera/rgb/image_raw" to="/follower/camera/rgb/image_raw"/>
        <remap from="/camera/depth/image_raw" to="/follower/camera/depth/image_raw"/>
        <remap from="/cmd_vel" to="/follower/cmd_vel"/>
    </node>

    <!-- 启动RViz可视化 -->
    <node pkg="rviz" type="rviz" name="rviz" 
          args="-d $(find track_pkg)/rviz/visual_track.rviz" required="false"/>

    <!-- 启动图像视图节点 -->
    <node pkg="rqt_image_view" type="rqt_image_view" name="image_view" required="false"/>
</launch> 